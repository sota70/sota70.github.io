<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>sota70の独り言</title>
    <link>http://localhost:1313/</link>
    <description>Recent content on sota70の独り言</description>
    <generator>Hugo</generator>
    <language>en</language>
    <lastBuildDate>Fri, 28 Feb 2025 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Nameless Cookieを用いたクッキーチェックのバイパス</title>
      <link>http://localhost:1313/posts/nameless-cookie/</link>
      <pubDate>Fri, 28 Feb 2025 17:19:28 +0900</pubDate>
      <guid>http://localhost:1313/posts/nameless-cookie/</guid>
      <description>&lt;h2 id=&#34;はじめに&#34;&gt;はじめに&lt;/h2&gt;&#xA;&lt;p&gt;Nameless Cookieは名前無しクッキーとも言われ、名前が存在せず値だけが存在するクッキーのことです。&lt;br&gt;&#xA;今回は名前無しクッキーを利用して特定のクッキーのセットを拒否するチェックをバイパスする方法を解説します。&lt;/p&gt;&#xA;&lt;h2 id=&#34;nameless-cookieとは&#34;&gt;Nameless Cookieとは&lt;/h2&gt;&#xA;&lt;p&gt;Nameless Cookieとは名前が存在せず、値だけが存在するクッキーのことです。&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Cookie: =value&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ですがこれは非推奨のクッキーです。&lt;br&gt;&#xA;これはRFC6265のクッキーの定義を見ることでも分かります。&lt;br&gt;&#xA;&lt;a href=&#34;https://datatracker.ietf.org/doc/html/rfc6265#section-4.1&#34;&gt;https://datatracker.ietf.org/doc/html/rfc6265#section-4.1&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set-cookie-string = cookie-pair *( &amp;#34;;&amp;#34; SP cookie-av )&#xA;cookie-pair       = cookie-name &amp;#34;=&amp;#34; cookie-value&#xA;cookie-name       = token&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;cookie-pairはcookie-nameとcookie-valueの組み合わせとなっています。&lt;br&gt;&#xA;cookie-nameの定義を確かめるためにtokenの定義を確認します。&lt;br&gt;&#xA;tokenはRFC2616から参照しています。&lt;br&gt;&#xA;&lt;a href=&#34;https://datatracker.ietf.org/doc/html/rfc2616#section-2.2&#34;&gt;https://datatracker.ietf.org/doc/html/rfc2616#section-2.2&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;token          = 1*&amp;lt;any CHAR except CTLs or separators&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;このことからクッキーの名前は最低でも特殊文字を除く1文字が必要だということが分かります。&lt;br&gt;&#xA;Nameless CookieはRFC6265bisで明確に使うべきでないとも主張しています。&lt;br&gt;&#xA;&lt;a href=&#34;https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-rfc6265bis&#34;&gt;https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-rfc6265bis&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Per the grammar above, servers SHOULD NOT produce nameless cookies (i.e.: an empty cookie-name) as such cookies may be unpredictably serialized by UAs when sent back to the server.&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ですが現状名前無しのクッキーを使用することができてしまいます。&lt;/p&gt;&#xA;&lt;h2 id=&#34;特定のクッキー設定を拒否するチェックのバイパス&#34;&gt;特定のクッキー設定を拒否するチェックのバイパス&lt;/h2&gt;&#xA;&lt;p&gt;以下のような任意のクッキーを設定できるエンドポイントにおいて&lt;br&gt;&#xA;特定のクッキーは設定することができないようなチェック機構が存在しているとします。&lt;/p&gt;</description>
    </item>
    <item>
      <title>About Old Blog</title>
      <link>http://localhost:1313/posts/about-old-blog/</link>
      <pubDate>Mon, 03 Feb 2025 16:02:07 +0900</pubDate>
      <guid>http://localhost:1313/posts/about-old-blog/</guid>
      <description>&lt;h2 id=&#34;古いブログについて&#34;&gt;古いブログについて&lt;/h2&gt;&#xA;&lt;p&gt;前まではqiitaに技術ブログを投稿していたのですが、今年に入ってからgithub.ioの個人ブログに移行しました。&lt;br&gt;&#xA;昔のブログが見たい方は&lt;a href=&#34;https://qiita.com/sota70&#34;&gt;こちら&lt;/a&gt;を参照してください。&lt;br&gt;&#xA;マニアックな技術の話やCTFのwriteupを主に投稿しています。&lt;/p&gt;</description>
    </item>
    <item>
      <title>防衛省CTF 2025 Writeup</title>
      <link>http://localhost:1313/posts/mod-ctf-writeup/</link>
      <pubDate>Mon, 03 Feb 2025 09:13:45 +0900</pubDate>
      <guid>http://localhost:1313/posts/mod-ctf-writeup/</guid>
      <description>&lt;h2 id=&#34;はじめに&#34;&gt;はじめに&lt;/h2&gt;&#xA;&lt;p&gt;今回は防衛省CTFに参加してきました。&lt;br&gt;&#xA;結果は以下の通りです。&lt;br&gt;&#xA;&lt;img src=&#34;https://raw.githubusercontent.com/sota70/sota70.github.io/refs/heads/main/public/posts/test/image.png?raw=true&#34; alt=&#34;alt text&#34;&gt;&lt;br&gt;&#xA;久しぶりのCTFで張り切っていたので12時間ずっとCTFしていました。&lt;br&gt;&#xA;かなりの問題数があるので私が面白いと思った問題だけ細かい解説を入れていきます。&lt;/p&gt;&#xA;&lt;h2 id=&#34;pg&#34;&gt;PG&lt;/h2&gt;&#xA;&lt;h3 id=&#34;縮めるだけじゃダメ&#34;&gt;縮めるだけじゃダメ&lt;/h3&gt;&#xA;&lt;p&gt;あるエクセルファイルが渡され、その中に記述されたフラグを抜き出す問題です。&lt;br&gt;&#xA;中にはGET_FLAGというマクロがありました。&lt;br&gt;&#xA;マクロの解析にはoletoolsを用いました。(&lt;a href=&#34;https://github.com/decalage2/oletools/tree/master/oletools&#34;&gt;https://github.com/decalage2/oletools/tree/master/oletools&lt;/a&gt;)&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;olevba 0.60.2 on Python 3.12.3 - http://decalage.info/python/oletools&#xA;===============================================================================&#xA;FILE: PG-1.xlsm&#xA;Type: OpenXML&#xA;WARNING  For now, VBA stomping cannot be detected for files in memory&#xA;-------------------------------------------------------------------------------&#xA;VBA MACRO ThisWorkbook.cls &#xA;in file: xl/vbaProject.bin - OLE stream: &amp;#39;VBA/ThisWorkbook&amp;#39;&#xA;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - &#xA;(empty macro)&#xA;-------------------------------------------------------------------------------&#xA;VBA MACRO Sheet1.cls &#xA;in file: xl/vbaProject.bin - OLE stream: &amp;#39;VBA/Sheet1&amp;#39;&#xA;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - &#xA;Sub GET_FLAG()&#xA;Worksheets(&amp;#34;Sheet1&amp;#34;).Activate&#xA;Rows(&amp;#34;1:7&amp;#34;).RowHeight = 30&#xA;Columns(&amp;#34;A:AT&amp;#34;).ColumnWidth = 30&#xA;Range(&amp;#34;A1:AT7&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;A1:AT1&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;A3:AT3&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;A5:AT5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Columns(&amp;#34;D&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Columns(&amp;#34;F&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Columns(&amp;#34;J&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Columns(&amp;#34;K&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Columns(&amp;#34;O&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Columns(&amp;#34;S&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Columns(&amp;#34;W&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Columns(&amp;#34;AA&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Columns(&amp;#34;AE&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Columns(&amp;#34;AI&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Columns(&amp;#34;AM&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Columns(&amp;#34;AQ&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;A1:A2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;C2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;C4:C5&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;G1:P2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;P5&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;AR2:AR4&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;AT1:AT2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;AT4:AT5&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;R2:R4&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;B1:B5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;E1:E5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;G3:G5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;I3:I6&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;L3:L5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;N3:N7&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;J6&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;L7:M7&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;Q1:Q5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;AS1:AS5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;T1:T5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;V1:V5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;X1:X5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;Z1:Z5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;AB1:AB5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;AD1:AD5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;AF1:AF5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;AH1:AH5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;AJ1:AJ5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;AL1:AL5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;AN1:AN5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;AP1:AP5&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;AN2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;AN4&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;T2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;V4&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;AL2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;Z2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;AJ4&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;AH2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;R2:V2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;R4:V4&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;W2:AA2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;W4:AA4&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;AB2:AH2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;AB4:AH4&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;AI2:AL2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;AI4:AL4&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;AM2:AR2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;AM4:AR4&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;R2:AR2&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;R4:AR4&amp;#34;).Interior.Color = RGB(0, 0, 0)&#xA;Range(&amp;#34;R2:AR2&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;Range(&amp;#34;R4:AR4&amp;#34;).Interior.Color = RGB(255, 255, 255)&#xA;End Sub&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;すると特定のセルを塗りつぶしていることが分かります。&lt;br&gt;&#xA;これを最後まで実行してしまうとフラグの内容が伏字になった状態で終わってしまうので&lt;br&gt;&#xA;1ステップずつ実行して、途中でフラグの内容が出てこないか確認します。&lt;br&gt;&#xA;するとマクロの中盤あたりで伏字にされるまえのフラグの状態を確認することができました。&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
